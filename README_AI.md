# 專案概述 (README_AI.md)

**專案名稱:** Sidep App (實際為預約/服務管理系統)

**專案性質:**
*   基於 **Vite + Vue** 的 Web 應用程式。
*   **非 Electron 應用程式**，`README.md` 中關於側邊欄的描述可能已過時或不適用於當前程式碼庫。

**核心功能 (已確認):**
*   預約/服務管理系統。
*   包含公共頁面 (如登陸頁、服務列表) 和管理員後台。

**目前進度與重要修改:**

1.  **登入/註冊導航:**
    *   在 `src/views/public/LandingPage.vue` 中添加了導向 `/account/signin` (登入) 和 `/account/signup` (註冊) 的按鈕/連結，方便使用者導航。
    *   **已移除 `LandingPage.vue` 中的局部導航，改為使用全局 Navbar。**
2.  **管理員登入:**
    *   確認管理員登入頁面為 `src/views/public/SignIn.vue` (路由 `/account/signin`)。
    *   測試管理員帳號: `admin@example.com` / `admin123`。
    *   管理員註冊驗證碼: `BEAUTY2025`。
    *   管理員登入後導向 `/admin` (儀表板)。
3.  **預約管理行事曆 (`src/views/admin/BookingCalendar.vue`):**
    *   **點擊日期新增預約:** 實現了點擊日曆中的日期即可彈出新增預約模態框，並自動帶入點擊的日期。
    *   **日期顯示錯誤修正:** 修正了因時區問題導致日期少一天的錯誤，確保日期正確顯示。
    *   **日視圖 UI 優化:**
        *   單日視圖下，日期單元格會放大並佔滿日曆區域。
        *   顯示更詳細的日期資訊和「本日無預約」提示。
    *   **週視圖 UI 優化:**
        *   增加了日期單元格的最小高度 (`min-h-32`)。
        *   優化了預約項目的顯示，增加了垂直間距 (`space-y-1`)。
        *   為預約項目列表添加了溢出滾動 (`overflow-y-auto max-h-24`)。
    *   **數據持久化:** 使用 `localStorage` 實現預約數據的儲存和載入，確保數據在重新整理後不會丟失。
    *   **預約操作優化:** 在儲存和刪除預約時，增加了載入狀態和更友好的提示（模擬後端整合）。
4.  **全局導航欄 (Navbar):**
    *   創建了 `src/components/Navbar.vue` 組件，包含「首頁」、「服務項目」、「立即預約」、「登入」、「註冊」和「管理員儀表板」連結。
    *   在 `src/App.vue` 中引入並使用了 `Navbar`，使其在所有頁面顯示。
    *   **已優化: Navbar 的響應式優化 (小螢幕下的漢堡菜單，並添加了浮動列表動畫，漢堡圖示應靠右顯示)。**
5.  **響應式設計優化 (所有頁面):**
    *   **`LandingPage.vue` (登陸頁面):** 調整了主視覺區塊高度、文字大小、按鈕組排列，確保在不同螢幕尺寸下良好呈現。
    *   **`SignIn.vue` (登入頁面):** 調整了容器內邊距、表單元素間距、字體大小和按鈕樣式，使其在小螢幕上更友好。
    *   **`SignUp.vue` (註冊頁面):** 類似於登入頁面，對表單佈局、輸入框大小、按鈕樣式和「同意條款」區塊進行了優化，確保在不同螢幕尺寸下都能良好呈現。
    *   **`ServiceList.vue` (服務項目列表):** 優化了篩選/排序區塊、服務項目卡片佈局和文字大小，使其在手機上更易於瀏覽。
    *   **`BookingFlow.vue` (預約流程):** 對多步驟流程的各個環節（步驟指示器、服務選擇、日期時間選擇、確認資訊、成功頁面）的佈局、字體大小、間距和按鈕進行了全面響應式優化。
    *   **`MyBookings.vue` (我的預約紀錄):** 優化了預約卡片佈局、文字大小和按鈕樣式，使其在不同螢幕尺寸下更具可讀性。
    *   **`Dashboard.vue` (管理員儀表板):** 優化了關鍵數據概覽卡片、快捷操作按鈕、數據可視化區塊和待處理預約列表的佈局和字體大小，**並已更新為從 `dataService.js` 載入數據。**
    *   **`ServiceManagement.vue` (服務項目管理):** 優化了頂部操作區塊、服務列表表格和新增/編輯服務模態框的佈局、字體大小、間距和按鈕樣式，使其在不同螢幕尺寸下都能良好呈現。
    *   **`ClientManagement.vue` (客戶名單管理):** 優化了搜尋輸入框和客戶列表表格的佈局、字體大小、間距和按鈕樣式，並為「查看詳情」操作添加了載入狀態和提示。
    *   **`BusinessSettings.vue` (營業設定):** 優化了營業時間和特別公休日設定區塊的佈局、字體大小、間距和按鈕樣式，使其在不同螢幕尺寸下都能良好呈現。
    *   **`AdminSetup.vue` (首次管理員設定):** 優化了表單佈局、字體大小、間距和按鈕樣式，使其在不同螢幕尺寸下都能良好呈現。

6.  **管理員功能完善:**
    *   **`ClientDetail.vue` (客戶詳情頁面):** 新增了客戶詳情頁面，用於顯示單個客戶的詳細資訊和編輯功能，並模擬了數據載入和更新操作，添加了載入狀態和通知提示。
    *   **`ClientManagement.vue` (客戶名單管理):** 將「查看詳情」按鈕改為彈出視窗，直接在當前頁面顯示和編輯客戶詳細資訊，無需跳轉頁面。原 `ClientDetail.vue` 已整合並移除。
    *   **`Dashboard.vue` (管理員儀表板):** 「近期待處理訂單」中的「查看詳情」按鈕現在以彈出視窗方式顯示預約詳情，並整合了編輯功能，原 `BookingDetail.vue` 已整合並移除。
    *   **`Dashboard.vue` (管理員儀表板):** 修改了「近期待處理訂單」中的「查看詳情」按鈕，使其導向到新的預約詳情頁面。

7.  **全局通知組件:**
    *   **已創建全局通知組件 (`Notification.vue`) 和組合式函數 (`useNotification.js`)，並將所有 `alert()` 調用替換為 `useNotification` 提供的通知。**

8.  **數據服務層:**
    *   **已創建 `src/services/dataService.js`，用於集中管理所有 `localStorage` 相關的數據操作。**
    *   **所有使用 `localStorage` 的組件都已更新為使用 `dataService.js` 進行數據持久化。**

9.  **用戶認證狀態管理:**
    *   **已創建 `src/composables/useAuth.js`，提供 `isLoggedIn`、`isAdmin`、`login` 和 `logout` 方法。**
    *   **`Navbar.vue` 已更新為根據登入狀態顯示不同按鈕，並實現登出功能。**
    *   **`SignIn.vue` 和 `SignUp.vue` 已更新為使用 `useAuth.js` 的 `login` 方法來設置用戶狀態。**
    *   **`AccountSettings.vue` 已更新為使用 `dataService.js` 載入和保存用戶數據。**
    *   **`Dashboard.vue` 已更新為從 `dataService.js` 載入數據。**
    *   **已添加全局導航守衛 (`src/router/index.js`)，確保只有登入用戶才能訪問受保護的路由，並且管理員用戶才能訪問管理員頁面。**

10. **模擬 API 層:**
    *   **已創建 `src/api/index.js`，用於提供模擬的 API 請求函數。**
    *   **`BookingCalendar.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`ServiceManagement.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`ClientManagement.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`ClientDetail.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`ServiceList.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`BookingFlow.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`MyBookings.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`AccountSettings.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **`SignIn.vue` 和 `SignUp.vue` 已更新為使用 `src/api/index.js` 進行數據操作。**
    *   **已解決 `ServiceManagement.vue` 中 `saveService` 重複宣告的錯誤 (將本地函數重新命名為 `handleSaveService`)。

11. **功能增強與優化:**
    *   **服務時長範圍化:** 在 `ServiceManagement.vue` 中，將服務的「所需時間時長」從單一數字改為「最短時長」和「最長時長」的範圍輸入。相應地更新了 `src/api/index.js` 和 `src/services/dataService.js` 以支援新的數據結構。
    *   **預約流程服務時長顯示修正:** 修正了 `BookingFlow.vue` 中服務時長顯示為 `NaN` 的問題，現在會正確顯示服務時長範圍。
    *   **營業設定新增不可預約日期與時間段落:** 在 `BusinessSettings.vue` 中新增了管理員設定不可預約日期和可預約時間段落的 UI 介面。相應地更新了 `src/api/index.js` 和 `src/services/dataService.js` 以支援新的數據結構和 API 函數。
    *   **營業設定頁面功能修正:** 修正了 `BusinessSettings.vue` 中新增按鈕無作用的問題，並確保在沒有設定可預約時間段時，預約流程頁面預設為全天可預約。
    *   **營業設定數據持久化修正:** 修正了 `src/services/dataService.js` 中營業設定（公休日、不可預約日期、可預約時間段落）的載入邏輯，確保預設數據只在 `localStorage` 中沒有資料時才寫入，解決了移除後預設數據仍保留的問題。
    *   **預約流程時間段預設邏輯優化:** 優化了 `BookingFlow.vue` 中可預約時間段的生成邏輯，當管理員未設定特定時間段時，將預設顯示營業時間內的所有時間段。
    *   **管理行事曆營業設定整合確認:** 確認 `BookingCalendar.vue` 已正確整合營業設定中的公休日、不可預約日期和營業時間，以標記日曆中的不可預約日期。可預約時間段落主要用於客戶端預約流程，管理員手動預約時可靈活輸入。
    *   **客戶端預約日期選擇器優化:** 將 `BookingFlow.vue` 中的日期輸入框替換為自定義的 `CustomerCalendar.vue` 組件，提供更直觀的日曆選擇體驗，並顯示已被預約的日期。
    *   **客戶端日曆組件錯誤修正:** 修正了 `CustomerCalendar.vue` 和 `BookingFlow.vue` 中因數據載入時序和 `ref` 變數存取方式導致的 `TypeError`。
    *   **預約流程步驟二錯誤修正:** 修正了 `BookingFlow.vue` 中選擇服務後點擊「下一步」時的錯誤，確保 `filteredAvailableTimes` 和 `isDateBookable` 在營業設定數據載入完成後才進行計算。
    *   **預約流程步驟三資訊補齊:** 在 `BookingFlow.vue` 的步驟三中加入了姓名、Email 和電話的輸入框，並修正了總價格的顯示位置。
    *   **預約編號生成優化:** 將預約編號的生成方式調整為 `BOOK` 前綴加上 6 位隨機英數字串，以提高唯一性和可讀性。
    *   **預約時間選擇精細化:**
        *   在 `BookingFlow.vue` 的步驟二中，時間選擇列表現在會顯示所有符合管理員設定的可預約時間段。
        *   已被預約的時間段會被禁用並標示為「(已預約)」。
        *   `CustomerCalendar.vue` 中的日曆顯示邏輯已優化，只有當某個日期的所有可預約時間段都被預約滿時，該日期才會顯示為「已預約」。
    *   **客戶端日曆「已預約」狀態邏輯優化:**
        *   修正了舊預約紀錄缺少 `totalDuration` 時，導致日曆可用性判斷錯誤的 bug (現在會預設為 30 分鐘)。
        *   日曆現在會根據使用者選擇的服務總時長 (`bookingDuration`)，動態檢查當天是否有足夠的**連續空閒時段**。
        *   如果找不到足夠長的連續時段，該日期將被正確標示為「已預約」，防止使用者選擇無法完成服務的日期。
    *   **服務項目圖片上傳:**
        *   在 `ServiceManagement.vue` 的新增/編輯服務視窗中，新增了圖片上傳及預覽功能。
        *   管理者可以上傳本地圖片，系統會將其轉換為 Base64 格式儲存，並顯示在服務列表及客戶端頁面。
        *   修正了 `ServiceList.vue` 中服務時長顯示不正確的問題。
    *   **服務項目管理列表篩選:**
        *   在 `ServiceManagement.vue` 頁面新增了依「類別」和「狀態」（上架中/已下架）篩選服務的功能，方便管理者快速查找特定服務。
    *   **我的預約紀錄體驗優化:**
        *   在 `MyBookings.vue` 頁面，使用者現在可以點擊任何一筆預約紀錄，來開啟一個顯示完整預約詳情的彈出視窗。
        *   彈出視窗內整合了「取消預約」功能（僅適用於即將到來的預約），提供更流暢的操作體驗。
    *   **管理員預約詳情編輯功能:**
        *   在 `BookingDetail.vue` 頁面，管理員現在可以點擊「編輯」按鈕，修改預約的「狀態」和「備註」。
        *   提供「儲存」和「取消」功能，確保數據修改的靈活性和安全性。

---

### Tips for Gemini CLI Agent

*   **每次有中大型的更新，請務必更新此 `README_AI.md` 檔案，記錄下專案的最新進度、重要修改和待辦事項。**
*   這將有助於您在每次啟動時快速了解專案上下文，提高工作效率。
*   請保持內容簡潔明瞭，重點突出。

---

**下一步可能的工作方向 (待確認):**
*   添加單元測試或端到端測試。
*   部署應用程式。
