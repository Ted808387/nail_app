# Sidep App - 美業預約管理系統

這是一個專為美業設計的預約管理系統，旨在提供客戶便捷的預約體驗，並賦予管理員高效的營運管理能力。

## 專案架構概覽

本專案分為三大核心區域：

*   **A. 公共區 (Public Pages)**：無需登入即可訪問，主要用於品牌展示、服務介紹及引導新用戶。
*   **B. 客戶專用區 (Customer Pages)**：需登入後訪問，提供客戶個人化的預約管理與帳號設定功能。

*   **C. 管理員後台 (Admin Dashboard)**：專為管理員設計，提供全面的店舖營運數據監控與管理功能。

---

## A. 公共區 (Public Pages) - 任何人都能看的門面

這些是訪客一進來就能看到的頁面，目標是吸引他們註冊或登入。

### 1. 首頁 / 形象頁 (Landing Page)

*   **功能詳述**:
    *   **品牌展示**: 透過高品質的圖片輪播、影片或精美排版，展示品牌風格、店舖環境、專業團隊。
    *   **主打服務/作品集**: 突出顯示最受歡迎或最新的服務項目，並展示精選作品案例。
    *   **客戶好評**: 引用真實客戶的評價或推薦，建立信任感。
    *   **核心價值/品牌故事**: 簡要介紹品牌理念或特色。
    *   **響應式設計**: 確保在不同設備（手機、平板、桌面）上都能提供最佳的視覺和操作體驗。
*   **目標**: 創造「哇！好美！好專業！」的第一印象，並透過明確的 **Call-to-Action (CTA)** 按鈕（如「查看服務」、「立即預約」）引導使用者進行下一步操作。
*   **技術需求**: 靜態內容為主，可考慮使用內容管理系統 (CMS) 或簡單的 JSON 配置來管理展示內容，以便未來快速更新。

### 2. 服務列表頁 (Service List)

*   **功能詳述**:
    *   **服務項目展示**: 清晰列出所有可提供的服務項目，每個項目包含：
        *   **名稱**: 服務的標題。
        *   **簡短描述**: 服務內容的精煉概述。
        *   **價格**: 服務費用。
        *   **所需時間**: 預計完成服務所需的時間。
        *   **圖片/圖示**: 視覺化呈現服務。
    *   **篩選與排序**: 提供按服務類別、價格區間、時長等進行篩選和排序的功能。
    *   **服務詳情彈窗/頁面**: 點擊服務項目後，彈出或導向一個新頁面，顯示更詳細的描述、多角度圖片、注意事項、適用人群等。
    *   **「加入預約」按鈕**: 每個服務項目旁直接提供預約按鈕，點擊後可直接將該服務加入預約流程。
*   **目標**: 讓使用者像瀏覽菜單一樣，輕鬆找到他們感興趣的服務，並快速進入預約環節。
*   **技術需求**: 從後端 API 動態獲取服務列表數據，支援分頁或無限滾動載入。

### 3. 註冊頁面 (/account/signup)

*   **功能詳述**:
    *   **用戶類型選擇**: 預設為普通客戶註冊，提供一個選項或輸入框供管理員輸入特定驗證碼以註冊為管理員帳號。
    *   **表單輸入**: 包含姓名、Email、密碼、確認密碼、手機號碼等必填欄位。
    *   **前端即時驗證**: 對 Email 格式、密碼強度（例如：至少8位、包含大小寫字母和數字）、手機號碼格式、必填項進行即時驗證，並提供清晰的錯誤提示。
    *   **隱私政策/服務條款同意**: 必須勾選同意才能完成註冊。
    *   **管理員驗證碼安全性**: 確保驗證碼的生成、分發和驗證機制安全可靠（例如：一次性使用、有時效性、僅限特定 IP 範圍）。
*   **目標**: 提供流暢、無痛且安全的註冊體驗，區分普通客戶與管理員的註冊路徑。
*   **技術需求**: 後端 API 處理用戶註冊、密碼加密儲存、管理員驗證碼驗證、防止重複註冊。

### 4. 登入頁面 (/account/signin)

*   **功能詳述**:
    *   **簡潔表單**: 僅包含 Email 和密碼輸入欄位。
    *   **前端驗證**: 確保 Email 格式正確且密碼不為空。
    *   **「忘記密碼」連結**: 導向密碼重設流程（可能包含 Email 驗證碼或連結）。
    *   **錯誤提示**: 登入失敗時顯示通用錯誤訊息（例如：「Email 或密碼不正確」），避免洩露用戶名是否存在。
    *   **「記住我」選項**: 允許使用者在下次訪問時無需重新登入（透過 Token 或 Session 管理）。
    **自動判斷角色**: 登入成功後，系統根據用戶角色（客戶或管理員）自動跳轉到對應的儀表板或首頁。
*   **目標**: 提供快速、安全且直觀的登入體驗。
*   **技術需求**: 後端 API 處理用戶登入驗證、Session/Token 管理、角色判斷與權限控制。

---

## B. 客戶專用區 (Customer Pages) - VIP 們的秘密花園

這些頁面需要登入後才能看到，專為已註冊的客戶服務。

### 1. 預約流程 (Booking Flow)

這是一連串的步驟，旨在提供順暢的預約體驗。

*   **功能詳述**:
    *   **步驟指示器**: 在頁面頂部或側邊顯示預約進度條或步驟指示器，讓使用者清楚知道目前在流程的哪一步。
    *   **步驟一：選擇服務**:
        *   **服務列表**: 再次展示服務列表，允許客戶選擇一個或多個服務。
        *   **服務時長與價格自動計算**: 根據所選服務自動計算總時長和總價格。
        *   **服務詳情預覽**: 點擊服務可快速預覽詳細資訊。
    *   **步驟二：選擇日期與時間**:
        *   **直觀日曆組件**: 使用易於操作的日曆/時間選擇器，清晰標示可預約和不可預約的日期/時間段。
        *   **即時可用性檢查**: 選擇日期後，即時顯示該日期的可用時間段，並考慮服務時長。
        *   **時區考量**: 如果有跨時區客戶，需考慮時區轉換和顯示。
    *   **步驟三：確認預約資訊**:
        *   **預約總結**: 清晰列出所有預約細節：所選服務、日期、時間、總時長、總價格、預約人資訊。
        *   **客戶資訊確認**: 讓客戶確認聯絡方式（姓名、手機、Email）是否正確，並允許修改。
        *   **備註欄位**: 提供一個可選的文字輸入框，讓客戶填寫特殊需求或備註。
        *   **最終確認按鈕**: 點擊後提交預約。
    *   **步驟四：預約成功頁**:
        *   **成功提示**: 顯示友好的成功訊息，例如「恭喜！您的預約已成功！」
        *   **預約編號**: 提供一個唯一的預約編號供客戶查詢。
        *   **添加到日曆**: 提供將預約添加到 Google Calendar 或 Outlook Calendar 的選項。
        *   **下一步建議**: 導向「我的預約紀錄」頁面或返回首頁。
*   **目標**: 讓預約過程像網購下單一樣簡單、絲滑，減少客戶的猶豫和操作障礙。
*   **技術需求**: 後端 API 處理預約創建、時間衝突檢查、服務時長計算、預約狀態管理。

### 2. 我的預約紀錄 (My Bookings)

*   **功能詳述**:
    *   **預約列表**: 分別顯示「即將到來的預約」和「歷史預約紀錄」。
    *   **預約詳情**: 每個預約項目可點擊查看詳細資訊，包括服務名稱、日期、時間、價格、狀態、服務人員（如果適用）。
    *   **取消預約功能**:
        *   **取消按鈕**: 在「即將到來的預約」中提供。
        *   **確認彈窗**: 點擊取消後彈出確認視窗，避免誤操作。
        *   **取消政策提示**: 在確認彈窗中明確告知取消規則（例如：24小時內不可取消，或可能產生費用）。
        *   **取消原因選項**: 可選的取消原因，便於管理員分析。
    *   **分頁/載入更多**: 如果預約紀錄很多，提供分頁或「載入更多」功能。
*   **目標**: 讓客戶能輕鬆管理自己的行程，查看所有預約狀態，並在需要時進行取消。
*   **技術需求**: 後端 API 獲取用戶預約列表、更新預約狀態、處理取消邏輯。

### 3. 帳號設定 (Account Settings)

*   **功能詳述**:
    *   **個人資料編輯**: 允許客戶修改姓名、聯絡電話、Email（Email 修改可能需要重新驗證）。
    *   **密碼變更**: 提供修改密碼功能，需輸入舊密碼驗證，並對新密碼進行強度檢查。
    *   **頭像上傳**: 如果系統支援用戶頭像，提供上傳和更換功能。
    *   **通知設定**: 允許客戶選擇是否接收預約提醒、促銷活動等 Email/簡訊通知。
*   **目標**: 提供客戶基本的帳號管理功能，增強用戶自主性。
*   **技術需求**: 後端 API 處理用戶資料更新、密碼加密與驗證。

---

## C. 管理員後台 (Admin Dashboard) - 你的總司令部！

這是專屬於你的秘密基地，所有商業機密和操作都在這裡！

### 1. 儀表板 (Dashboard)

*   **功能詳述**:
    *   **關鍵數據概覽**: 登入後的第一個畫面，以圖表和數字形式展示核心營運數據：
        *   今日/本週/本月預約數。
        *   本週/本月預估收入。
        *   近期新客戶數量。
        *   最受歡迎的服務項目。
        *   待處理的預約請求（如果預約需要審核）。
    *   **數據可視化**: 使用專業的圖表庫（如 Chart.js, ECharts, ApexCharts）來呈現數據，使其直觀易懂。
    *   **實時更新**: 關鍵數據可設定定期刷新，確保資訊的即時性。
    *   **快捷操作**: 提供常用功能的快捷入口，例如「新增預約」、「查看今日預約」。
*   **目標**: 讓管理員一秒掌握店舖的營運狀況，做出快速決策。
*   **技術需求**: 後端 API 提供各類統計數據，可能需要數據聚合和緩存機制。

### 2. 預約管理行事曆 (Booking Calendar View)

*   **功能詳述**:
    *   **多視圖切換**: 提供日、週、月視圖，方便管理員從不同時間維度查看預約。
    *   **預約顯示**: 在行事曆上清晰標示所有客戶的預約，可顯示客戶姓名、服務項目、時間。
    *   **顏色標記**: 根據預約狀態（例如：已確認、待處理、已取消、已完成）使用不同顏色標記，一目了然。
    *   **預約詳情彈窗**: 點擊行事曆上的預約，彈出詳細資訊視窗，包含客戶聯絡方式、服務細節、備註等。
    *   **手動新增/修改預約**: 允許管理員手動為客戶新增預約，或修改現有預約的時間、服務、客戶資訊。
    *   **拖曳調整**: 允許管理員在行事曆上拖曳預約來調整時間（需處理時間衝突）。
    *   **不開放預約設定**: 允許管理員設定特定時段為不可預約（例如：午休、私人時間、員工培訓），這些時段在客戶端將顯示為不可選。
    *   **衝突檢測**: 在新增或修改預約時，自動檢測時間衝突並給予提示。
*   **目標**: 成為管理員的時間管理大師，所有預約一目了然，並能靈活調整。
*   **技術需求**: 後端 API 處理預約的 CRUD (Create, Read, Update, Delete) 操作、複雜的時間衝突管理邏輯。

### 3. 服務項目管理 (Service Management)

*   **功能詳述**:
    *   **服務列表**: 展示所有服務項目，提供搜尋、篩選（按類別、狀態）和排序功能。
    *   **新增/編輯表單**: 完整的表單，用於新增或修改服務項目，包含：
        *   服務名稱、詳細描述。
        *   價格、所需時間。
        *   服務類別。
        *   圖片上傳（支援多圖）。
        *   上架/下架狀態開關。
        *   是否為熱門服務標籤。
    *   **批量操作**: 允許管理員批量上架、下架或刪除服務項目。
*   **目標**: 讓管理員能輕鬆管理店舖的「菜單」，隨時更新服務內容和價格。
*   **技術需求**: 後端 API 處理服務項目的 CRUD 操作、圖片儲存與管理。

### 4. 客戶名單管理 (Client Management)

*   **功能詳述**:
    *   **客戶列表**: 展示所有註冊過的客戶列表，提供搜尋（按姓名、電話、Email）和篩選功能。
    *   **客戶詳情頁**: 點擊客戶可進入其詳細資料頁面，查看：
        *   基本聯絡資訊。
        *   所有歷史預約紀錄（可連結到預約詳情）。
        *   客戶備註（管理員可添加）。
    *   **新增客戶**: 允許管理員手動新增客戶（例如：電話預約的客戶）。
    *   **編輯客戶資訊**: 允許管理員修改客戶的基本資料。
*   **目標**: 建立管理員的客戶關係管理 (CRM) 系統，方便追蹤客戶資訊和歷史互動。
*   **技術需求**: 後端 API 獲取客戶列表、客戶資料的 CRUD 操作。

### 5. 營業設定 (Business Settings)

*   **功能詳述**:
    *   **營業時間設定**: 設定每週的營業時間（例如：週一至週五 10:00-19:00），可設定每日不同的營業時間或休息日。
    *   **特殊日期設定**: 允許管理員設定國定假日、臨時休假或特殊營業時間。
    *   **預約規則設定**:
        *   最晚預約時間（例如：預約必須在服務開始前 2 小時完成）。
        *   最晚取消時間（例如：預約必須在服務開始前 24 小時取消）。
        *   預約間隔時間（例如：預約之間至少間隔 15 分鐘）。
    *   **通知模板設定**: 允許管理員編輯預約確認 Email/簡訊、預約提醒、取消通知等模板內容。
*   **目標**: 讓系統知道店舖何時有空，並自動執行預約規則，減少人工干預。
*   **技術需求**: 後端 API 儲存和讀取營業設定、預約規則的邏輯判斷。

### 6. 管理員初始設定頁 (/admin-setup)

*   **功能詳述**:
    *   **引導式設定**: 專為首次部署或初始化系統設計，引導管理員完成必要的初始設定。
    *   **管理員帳號創建**: 創建第一個管理員帳號（用戶名、密碼）。
    *   **店舖基本資訊**: 設定店舖名稱、聯絡電話、地址等。
    *   **安全性考量**: 確保此頁面只能在特定條件下（例如：資料庫中沒有管理員帳號時）被訪問一次，完成後自動禁用或重定向。
*   **目標**: 快速完成系統的第一次開機設定，確保系統正常運行。
*   **技術需求**: 後端 API 處理管理員帳號創建、初始化系統配置，並有訪問控制機制。

---

## 整體技術考量與建議

*   **前端框架**: Vue.js (已選)
*   **後端框架**: 建議使用 Node.js (Express.js / NestJS) 或 Python (FastAPI / Django REST Framework)
*   **資料庫**:
    *   **關聯式資料庫**: PostgreSQL (推薦，適合複雜的關係型數據，如預約、服務、用戶)
    *   **非關聯式資料庫**: MongoDB (如果數據結構彈性大，如日誌、部分設定)
*   **API 設計**: 採用 RESTful API 設計原則，提供清晰的接口文檔 (例如使用 Swagger/OpenAPI)。
*   **認證與授權**:
    *   **認證**: JWT (JSON Web Tokens) 或基於 Session 的認證。
    *   **授權**: 基於角色的訪問控制 (RBAC)，確保不同角色（客戶、管理員）只能訪問其權限範圍內的資源。
*   **錯誤處理**: 建立全局錯誤處理機制，提供友好的錯誤訊息。
*   **通知系統**: 整合 Email 和/或 SMS 服務，用於發送預約確認、提醒、取消通知、密碼重設等。
*   **部署**: 考慮使用 Docker 進行容器化部署，方便環境管理和擴展。
*   **測試**: 實施單元測試、整合測試和端到端測試，確保系統的穩定性和可靠性。
*   **版本控制**: 使用 Git 進行版本控制，並遵循 Git Flow 或 Trunk-based Development 工作流。

---

## 前端開發進度

### 階段一：前端 `dataService` 替換為真實 API 呼叫

1.  **安裝 Axios：**
    *   在 `sidep_app` 專案中安裝了 `axios` HTTP 客戶端函式庫。

2.  **配置 Axios 實例與 JWT 攔截器：**
    *   修改了 `src/api/index.js`，引入 `axios` 並配置 `apiClient` 實例。
    *   設定後端 API 的基礎 URL (`http://127.0.0.1:8000`)。
    *   添加請求攔截器，用於自動在每個受保護的請求中添加 JWT Token 到 `Authorization` 頭部。
    *   添加響應攔截器，用於處理全局錯誤（例如 401 Unauthorized，自動跳轉到登入頁）。

3.  **替換認證相關的 API 呼叫：**
    *   修改了 `src/api/index.js` 中的 `registerUser` 和 `loginUser` 函數，使其呼叫後端 `/auth/register` 和 `/auth/login` 端點。
    *   在 `loginUser` 成功後，將返回的 JWT Token 儲存到 `localStorage` 中。

4.  **替換預約相關的 API 呼叫：**
    *   修改了 `src/api/index.js` 中的 `fetchBookings`、`saveBooking` 和 `deleteBooking` 函數，使其呼叫後端 `/bookings` 端點。

5.  **替換服務相關的 API 呼叫：**
    *   修改了 `src/api/index.js` 中的 `fetchServices`、`saveService`、`updateServiceStatus`、`deleteServiceApi` 和 `bulkServiceAction` 函數，使其呼叫後端 `/services` 端點。

6.  **替換客戶相關的 API 呼叫：**
    *   修改了 `src/api/index.js` 中的 `fetchClients`、`fetchClientById` 和 `updateClient` 函數，使其呼叫後端 `/admin/clients` 端點。

7.  **替換營業設定相關的 API 呼叫：**
    *   修改了 `src/api/index.js` 中的 `fetchBusinessSettings`、`saveBusinessSettings`、`addHoliday`、`removeHoliday`、`addUnavailableDateApi` 和 `removeUnavailableDateApi` 函數，使其呼叫後端 `/admin/settings` 端點。

**目前狀態：**

*   前端專案 `sidep_app` 中的 `src/api/index.js` 檔案已完成修改，所有模擬的 `dataService` 呼叫都已替換為對後端 FastAPI API 的實際 HTTP 請求。
*   `updateServiceStatus`、`bulkServiceAction`、`addTimeSlotApi`、`removeTimeSlotApi`、`fetchUserById`、`updateUserProfile` 和 `changeUserPassword` 這些函數在前端仍有 `console.warn` 提示，因為後端目前沒有直接對應的 API 端點。

**下一步：**

1.  **啟動前端開發伺服器：** 在 `sidep_app` 資料夾中執行 `npm run dev`。
2.  **啟動後端 FastAPI 應用程式：** 在 `sidep_backend` 資料夾中執行 `uvicorn main:app --reload`。
3.  **測試前端應用程式：** 在瀏覽器中訪問前端應用程式，並測試其功能，例如註冊、登入、查看服務、預約等，看看它們是否能正確地與後端互動。
